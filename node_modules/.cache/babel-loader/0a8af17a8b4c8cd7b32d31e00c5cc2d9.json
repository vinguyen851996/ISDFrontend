{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Thuc Vi\\\\Desktop\\\\ISDFrontend\\\\src\\\\components\\\\Core\\\\context\\\\UserContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React from 'react';\nimport axios from 'axios';\nimport jwt from 'jsonwebtoken';\nimport { mockUser } from './mock'; //config\n\nimport config from '../../src/config';\nimport { showSnackbar } from '../components/Snackbar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet UserStateContext = /*#__PURE__*/React.createContext();\nlet UserDispatchContext = /*#__PURE__*/React.createContext();\n\nfunction userReducer(state, action) {\n  switch (action.type) {\n    case 'LOGIN_SUCCESS':\n      return { ...state,\n        ...action.payload\n      };\n\n    case 'REGISTER_REQUEST':\n    case 'RESET_REQUEST':\n    case 'PASSWORD_RESET_EMAIL_REQUEST':\n      return { ...state,\n        isFetching: true,\n        errorMessage: ''\n      };\n\n    case 'SIGN_OUT_SUCCESS':\n      return { ...state\n      };\n\n    case 'AUTH_INIT_ERROR':\n      return Object.assign({}, state, {\n        currentUser: null,\n        loadingInit: false\n      });\n\n    case 'REGISTER_SUCCESS':\n    case 'RESET_SUCCESS':\n    case 'PASSWORD_RESET_EMAIL_SUCCESS':\n      return Object.assign({}, state, {\n        isFetching: false,\n        errorMessage: ''\n      });\n\n    case 'AUTH_FAILURE':\n      return Object.assign({}, state, {\n        isFetching: false,\n        errorMessage: action.payload\n      });\n\n    default:\n      {\n        throw new Error(`Unhandled action type: ${action.type}`);\n      }\n  }\n}\n\nfunction UserProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  let [state, dispatch] = React.useReducer(userReducer, {\n    isAuthenticated: () => {\n      const token = localStorage.getItem('token');\n\n      if (config.isBackend && token) {\n        const date = new Date().getTime() / 1000;\n        const data = jwt.decode(token);\n        if (!data) return false;\n        return date < data.exp;\n      } else if (token) {\n        return true;\n      }\n\n      return false;\n    },\n    isFetching: false,\n    errorMessage: '',\n    currentUser: null,\n    loadingInit: true\n  });\n  return /*#__PURE__*/_jsxDEV(UserStateContext.Provider, {\n    value: state,\n    children: /*#__PURE__*/_jsxDEV(UserDispatchContext.Provider, {\n      value: dispatch,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n\n_s(UserProvider, \"bPI5/BSlw3DUw92AMkWxf+x3XIw=\");\n\n_c = UserProvider;\n\nfunction useUserState() {\n  _s2();\n\n  let context = React.useContext(UserStateContext);\n\n  if (context === undefined) {\n    throw new Error('useUserState must be used within a UserProvider');\n  }\n\n  return context;\n}\n\n_s2(useUserState, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nfunction useUserDispatch() {\n  _s3();\n\n  let context = React.useContext(UserDispatchContext);\n\n  if (context === undefined) {\n    throw new Error('useUserDispatch must be used within a UserProvider');\n  }\n\n  return context;\n}\n\n_s3(useUserDispatch, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nexport { UserProvider, useUserState, useUserDispatch, loginUser, signOut }; // ###########################################################\n\nfunction loginUser(dispatch, login, password, history, setIsLoading, setError) {\n  let social = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : '';\n  setError(false);\n  setIsLoading(true); // We check if app runs with backend mode\n\n  if (!config.isBackend) {\n    setError(null);\n    doInit()(dispatch);\n    setIsLoading(false);\n    receiveToken('token', dispatch);\n  } else {\n    if (!!social) {\n      window.location.href = config.baseURLApi + '/auth/signin/' + social + '?app=' + config.redirectUrl;\n    } else if (login.length > 0 && password.length > 0) {\n      axios.post('/auth/signin/local', {\n        email: login,\n        password\n      }).then(res => {\n        const token = res.data;\n        setError(null);\n        setIsLoading(false);\n        receiveToken(token, dispatch);\n        doInit()(dispatch);\n      }).catch(() => {\n        setError(true);\n        setIsLoading(false);\n      });\n    } else {\n      dispatch({\n        type: 'LOGIN_FAILURE'\n      });\n    }\n  }\n}\n\nexport function sendPasswordResetEmail(email) {\n  return dispatch => {\n    if (!config.isBackend) {\n      return;\n    } else {\n      dispatch({\n        type: 'PASSWORD_RESET_EMAIL_REQUEST'\n      });\n      axios.post('/auth/send-password-reset-email', {\n        email\n      }).then(res => {\n        dispatch({\n          type: 'PASSWORD_RESET_EMAIL_SUCCESS'\n        });\n        showSnackbar({\n          type: 'success',\n          message: 'Email with resetting instructions has been sent'\n        });\n      }).catch(err => {\n        dispatch(authError(err.response.data));\n      });\n    }\n  };\n}\n\nfunction signOut(dispatch, history) {\n  localStorage.removeItem('token');\n  localStorage.removeItem('user');\n  localStorage.removeItem('user_id');\n  document.cookie = 'token=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n  axios.defaults.headers.common['Authorization'] = '';\n  dispatch({\n    type: 'SIGN_OUT_SUCCESS'\n  });\n  history.push('/login');\n}\n\nexport function receiveToken(token, dispatch) {\n  let user; // We check if app runs with backend mode\n\n  if (config.isBackend) {\n    user = jwt.decode(token).user;\n    delete user.id;\n  } else {\n    user = {\n      email: config.auth.email\n    };\n  }\n\n  delete user.id;\n  localStorage.setItem('token', token);\n  localStorage.setItem('user', JSON.stringify(user));\n  localStorage.setItem('theme', 'default');\n  axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n  dispatch({\n    type: 'LOGIN_SUCCESS'\n  });\n}\n\nasync function findMe() {\n  if (config.isBackend) {\n    const response = await axios.get('/auth/me');\n    return response.data;\n  } else {\n    return mockUser;\n  }\n}\n\nexport function authError(payload) {\n  return {\n    type: 'AUTH_FAILURE',\n    payload\n  };\n}\nexport function doInit() {\n  return async dispatch => {\n    let currentUser = null;\n\n    if (!config.isBackend) {\n      currentUser = mockUser;\n      dispatch({\n        type: 'LOGIN_SUCCESS',\n        payload: {\n          currentUser\n        }\n      });\n    } else {\n      try {\n        let token = localStorage.getItem('token');\n\n        if (token) {\n          currentUser = await findMe();\n        }\n\n        sessionStorage.setItem('user_id', currentUser.id);\n        dispatch({\n          type: 'LOGIN_SUCCESS',\n          payload: {\n            currentUser\n          }\n        });\n      } catch (error) {\n        console.log(error);\n        dispatch({\n          type: 'AUTH_INIT_ERROR',\n          payload: error\n        });\n      }\n    }\n  };\n}\nexport function registerUser(dispatch, login, password, history, setIsLoading, setError) {\n  let social = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : '';\n  return () => {\n    if (!config.isBackend) {\n      history.push('/login');\n    } else {\n      dispatch({\n        type: 'REGISTER_REQUEST'\n      });\n\n      if (login.length > 0 && password.length > 0) {\n        axios.post('/auth/signup', {\n          email: login,\n          password\n        }).then(res => {\n          dispatch({\n            type: 'REGISTER_SUCCESS'\n          });\n          showSnackbar({\n            type: 'success',\n            message: \"You've been registered successfully. Please check your email for verification link\"\n          });\n          history.push('/login');\n        }).catch(err => {\n          dispatch(authError(err.response.data));\n        });\n      } else {\n        dispatch(authError('Something was wrong. Try again'));\n      }\n    }\n  };\n}\nexport function verifyEmail(token, history) {\n  return dispatch => {\n    if (!config.isBackend) {\n      history.push('/login');\n    } else {\n      axios.put('/auth/verify-email', {\n        token\n      }).then(verified => {\n        if (verified) {\n          showSnackbar({\n            type: 'success',\n            message: 'Your email was verified'\n          });\n        }\n      }).catch(err => {\n        showSnackbar({\n          type: 'error',\n          message: err.response\n        });\n      }).finally(() => {\n        history.push('/login');\n      });\n    }\n  };\n}\nexport function resetPassword(token, password, history) {\n  return dispatch => {\n    if (!config.isBackend) {\n      history.push('/login');\n    } else {\n      dispatch({\n        type: 'RESET_REQUEST'\n      });\n      axios.put('/auth/password-reset', {\n        token,\n        password\n      }).then(res => {\n        dispatch({\n          type: 'RESET_SUCCESS'\n        });\n        showSnackbar({\n          type: 'success',\n          message: 'Password has been updated'\n        });\n        history.push('/login');\n      }).catch(err => {\n        dispatch(authError(err.response.data));\n      });\n    }\n  };\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["React","axios","jwt","mockUser","config","showSnackbar","UserStateContext","createContext","UserDispatchContext","userReducer","state","action","type","payload","isFetching","errorMessage","Object","assign","currentUser","loadingInit","Error","UserProvider","children","dispatch","useReducer","isAuthenticated","token","localStorage","getItem","isBackend","date","Date","getTime","data","decode","exp","useUserState","context","useContext","undefined","useUserDispatch","loginUser","signOut","login","password","history","setIsLoading","setError","social","doInit","receiveToken","window","location","href","baseURLApi","redirectUrl","length","post","email","then","res","catch","sendPasswordResetEmail","message","err","authError","response","removeItem","document","cookie","defaults","headers","common","push","user","id","auth","setItem","JSON","stringify","findMe","get","sessionStorage","error","console","log","registerUser","verifyEmail","put","verified","finally","resetPassword"],"sources":["C:/Users/Thuc Vi/Desktop/ISDFrontend/src/components/Core/context/UserContext.js"],"sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport jwt from 'jsonwebtoken';\n\nimport { mockUser } from './mock';\n\n//config\nimport config from '../../src/config';\nimport { showSnackbar } from '../components/Snackbar';\n\nlet UserStateContext = React.createContext();\nlet UserDispatchContext = React.createContext();\n\nfunction userReducer(state, action) {\n  switch (action.type) {\n    case 'LOGIN_SUCCESS':\n      return {\n        ...state,\n        ...action.payload,\n      };\n    case 'REGISTER_REQUEST':\n    case 'RESET_REQUEST':\n    case 'PASSWORD_RESET_EMAIL_REQUEST':\n      return {\n        ...state,\n        isFetching: true,\n        errorMessage: '',\n      };\n    case 'SIGN_OUT_SUCCESS':\n      return { ...state };\n    case 'AUTH_INIT_ERROR':\n      return Object.assign({}, state, {\n        currentUser: null,\n        loadingInit: false,\n      });\n    case 'REGISTER_SUCCESS':\n    case 'RESET_SUCCESS':\n    case 'PASSWORD_RESET_EMAIL_SUCCESS':\n      return Object.assign({}, state, {\n        isFetching: false,\n        errorMessage: '',\n      });\n    case 'AUTH_FAILURE':\n      return Object.assign({}, state, {\n        isFetching: false,\n        errorMessage: action.payload,\n      });\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`);\n    }\n  }\n}\n\nfunction UserProvider({ children }) {\n  let [state, dispatch] = React.useReducer(userReducer, {\n    isAuthenticated: () => {\n      const token = localStorage.getItem('token');\n      if (config.isBackend && token) {\n        const date = new Date().getTime() / 1000;\n        const data = jwt.decode(token);\n        if (!data) return false;\n        return date < data.exp;\n      } else if (token) {\n        return true;\n      }\n      return false;\n    },\n    isFetching: false,\n    errorMessage: '',\n    currentUser: null,\n    loadingInit: true,\n  });\n\n  return (\n    <UserStateContext.Provider value={state}>\n      <UserDispatchContext.Provider value={dispatch}>\n        {children}\n      </UserDispatchContext.Provider>\n    </UserStateContext.Provider>\n  );\n}\n\nfunction useUserState() {\n  let context = React.useContext(UserStateContext);\n  if (context === undefined) {\n    throw new Error('useUserState must be used within a UserProvider');\n  }\n  return context;\n}\n\nfunction useUserDispatch() {\n  let context = React.useContext(UserDispatchContext);\n  if (context === undefined) {\n    throw new Error('useUserDispatch must be used within a UserProvider');\n  }\n  return context;\n}\n\nexport { UserProvider, useUserState, useUserDispatch, loginUser, signOut };\n\n// ###########################################################\n\nfunction loginUser(\n  dispatch,\n  login,\n  password,\n  history,\n  setIsLoading,\n  setError,\n  social = '',\n) {\n  setError(false);\n  setIsLoading(true);\n  // We check if app runs with backend mode\n  if (!config.isBackend) {\n    setError(null);\n    doInit()(dispatch);\n    setIsLoading(false);\n    receiveToken('token', dispatch);\n  } else {\n    if (!!social) {\n      window.location.href =\n        config.baseURLApi +\n        '/auth/signin/' +\n        social +\n        '?app=' +\n        config.redirectUrl;\n    } else if (login.length > 0 && password.length > 0) {\n      axios\n        .post('/auth/signin/local', { email: login, password })\n        .then((res) => {\n          const token = res.data;\n          setError(null);\n          setIsLoading(false);\n          receiveToken(token, dispatch);\n          doInit()(dispatch);\n        })\n        .catch(() => {\n          setError(true);\n          setIsLoading(false);\n        });\n    } else {\n      dispatch({ type: 'LOGIN_FAILURE' });\n    }\n  }\n}\n\nexport function sendPasswordResetEmail(email) {\n  return (dispatch) => {\n    if (!config.isBackend) {\n      return;\n    } else {\n      dispatch({\n        type: 'PASSWORD_RESET_EMAIL_REQUEST',\n      });\n      axios\n        .post('/auth/send-password-reset-email', { email })\n        .then((res) => {\n          dispatch({\n            type: 'PASSWORD_RESET_EMAIL_SUCCESS',\n          });\n          showSnackbar({\n            type: 'success',\n            message: 'Email with resetting instructions has been sent',\n          });\n        })\n        .catch((err) => {\n          dispatch(authError(err.response.data));\n        });\n    }\n  };\n}\n\nfunction signOut(dispatch, history) {\n  localStorage.removeItem('token');\n  localStorage.removeItem('user');\n  localStorage.removeItem('user_id');\n  document.cookie = 'token=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n  axios.defaults.headers.common['Authorization'] = '';\n  dispatch({ type: 'SIGN_OUT_SUCCESS' });\n  history.push('/login');\n}\n\nexport function receiveToken(token, dispatch) {\n  let user;\n\n  // We check if app runs with backend mode\n  if (config.isBackend) {\n    user = jwt.decode(token).user;\n    delete user.id;\n  } else {\n    user = {\n      email: config.auth.email,\n    };\n  }\n\n  delete user.id;\n  localStorage.setItem('token', token);\n  localStorage.setItem('user', JSON.stringify(user));\n  localStorage.setItem('theme', 'default');\n  axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n  dispatch({ type: 'LOGIN_SUCCESS' });\n}\n\nasync function findMe() {\n  if (config.isBackend) {\n    const response = await axios.get('/auth/me');\n    return response.data;\n  } else {\n    return mockUser;\n  }\n}\n\nexport function authError(payload) {\n  return {\n    type: 'AUTH_FAILURE',\n    payload,\n  };\n}\n\nexport function doInit() {\n  return async (dispatch) => {\n    let currentUser = null;\n    if (!config.isBackend) {\n      currentUser = mockUser;\n\n      dispatch({\n        type: 'LOGIN_SUCCESS',\n        payload: {\n          currentUser,\n        },\n      });\n    } else {\n      try {\n        let token = localStorage.getItem('token');\n        if (token) {\n          currentUser = await findMe();\n        }\n        sessionStorage.setItem('user_id', currentUser.id);\n        dispatch({\n          type: 'LOGIN_SUCCESS',\n          payload: {\n            currentUser,\n          },\n        });\n      } catch (error) {\n        console.log(error);\n\n        dispatch({\n          type: 'AUTH_INIT_ERROR',\n          payload: error,\n        });\n      }\n    }\n  };\n}\n\nexport function registerUser(\n  dispatch,\n  login,\n  password,\n  history,\n  setIsLoading,\n  setError,\n  social = '',\n) {\n  return () => {\n    if (!config.isBackend) {\n      history.push('/login');\n    } else {\n      dispatch({\n        type: 'REGISTER_REQUEST',\n      });\n      if (login.length > 0 && password.length > 0) {\n        axios\n          .post('/auth/signup', { email: login, password })\n          .then((res) => {\n            dispatch({\n              type: 'REGISTER_SUCCESS',\n            });\n            showSnackbar({\n              type: 'success',\n              message:\n                \"You've been registered successfully. Please check your email for verification link\",\n            });\n            history.push('/login');\n          })\n          .catch((err) => {\n            dispatch(authError(err.response.data));\n          });\n      } else {\n        dispatch(authError('Something was wrong. Try again'));\n      }\n    }\n  };\n}\n\nexport function verifyEmail(token, history) {\n  return (dispatch) => {\n    if (!config.isBackend) {\n      history.push('/login');\n    } else {\n      axios\n        .put('/auth/verify-email', { token })\n        .then((verified) => {\n          if (verified) {\n            showSnackbar({\n              type: 'success',\n              message: 'Your email was verified',\n            });\n          }\n        })\n        .catch((err) => {\n          showSnackbar({ type: 'error', message: err.response });\n        })\n        .finally(() => {\n          history.push('/login');\n        });\n    }\n  };\n}\n\nexport function resetPassword(token, password, history) {\n  return (dispatch) => {\n    if (!config.isBackend) {\n      history.push('/login');\n    } else {\n      dispatch({\n        type: 'RESET_REQUEST',\n      });\n      axios\n        .put('/auth/password-reset', { token, password })\n        .then((res) => {\n          dispatch({\n            type: 'RESET_SUCCESS',\n          });\n          showSnackbar({\n            type: 'success',\n            message: 'Password has been updated',\n          });\n          history.push('/login');\n        })\n        .catch((err) => {\n          dispatch(authError(err.response.data));\n        });\n    }\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}